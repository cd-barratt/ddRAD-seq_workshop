---
title: 'Tutorial: RAxML'
output:
  html_document: default
  word_document: default
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, eval = FALSE,
                      echo=TRUE, warning=FALSE, message=FALSE,
                      tidy = TRUE, collapse = TRUE,
                      results = 'hold')
```
\
\

### Timings 
  1. Run RAxML (ca. 1 hour for 10 bootstraps)
  
All done in EVE cluster
  
\
\

### Objectives

We've looked at 3 methods for looking at population structure. We can also confirm this information on population structure from a phylogeny, by looking at how the individuals and populations cluster within a tree. More interestingly we can look at the relationships between populations (something that is not particularly clear with Admixture, sNMF and DAPC analyses)

\ 

For this exercise we will use [RAxML](https://cme.h-its.org/exelixis/web/software/raxml/) on the EVE cluster to investigate phylogenetic relationships. Note that we will not do any phylogenetic dating here, for that you could use a variety of other things, for example [BEAST](https://beast.community/). 

\
\

### 1. Run RAxML
#This is all done in the EVE cluster, it will take some time - we can reduce the number of bootstrap replicates...

```{r}
### RAxML
#!/bin/bash                                                                                                                            

#SBATCH --job-name=RAxML
#SBATCH --mail-user=christopher_david.barratt@uni-leipzig.de
#SBATCH --mail-type=BEGIN,END,FAIL,TIME_LIMIT
#SBATCH --output=~/work/ddRAD-seq_workshop/job_logs/%x-%j.log
#SBATCH --cpus-per-task=1 
#SBATCH --mem-per-cpu=20G
#SBATCH --time=12:00:00

#load environment
module purge 
module load GCC/10.2.0
module load OpenMPI/4.0.5
module load RAxML/8.2.12-hybrid-avx2

cd  ~/work/ddRAD-seq_workshop/outputs/Exercise_7/

# 5 bootstraps
raxmlHPC -f a -m GTRCAT -p 12345 -x 12345 -# 5 -s  ~/work/ddRAD-seq_workshop/data/Exercises_4-8/RAxML/Lflav.phy ­­asc­corr=lewis -n bootstrapped 
raxmlHPC -m GTRCAT -p 12345 -f b -t RAxML_bestTree.bootstrapped -z RAxML_bootstrap.bootstrapped -n FINAL_bootstrapped.tre

```

\
\

### On your own...

You can rerun RAxML with different parameter settings, for example by changing the number of bootstraps by changing the number in the first line to -# 100 instead of -# 5 (100 recommended but this takes time). You could also look at different models of evolution instead of GTRCAT, or try a different ascertainment bias correction (not lewis)
